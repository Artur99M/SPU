#ifndef STACK_PROTECTION_H
#define STACK_PROTECTION_H

#define STACK_DUMP(p) StackDump(p, #p, __FILE__, __LINE__, __func__)

#include <time.h>

typedef time_t canary_t;
enum STACK_ERROR
{
    STACK_NO_ERROR = 0,
    LEFT_STACK_CANARY_DIED = 1,
    RIGHT_STACK_CANARY_DIED = 2,
    LEFT_STACK_DATA_CANARY_DIED = 4,
    RIGHT_STACK_DATA_CANARY_DIED = 8,
    LEFT_STACK_CANARY_DIED_AND_RIGHT_STACK_CANARY_DIED = 3,
    LEFT_STACK_CANARY_DIED_AND_LEFT_STACK_DATA_CANARY_DIED = 5,
    LEFT_STACK_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 9,
    RIGHT_STACK_CANARY_DIED_AND_LEFT_STACK_DATA_CANARY_DIED = 6,
    RIGHT_STACK_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 10,
    LEFT_STACK_DATA_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 12,
    RIGHT_STACK_CANARY_DIED_AND_LEFT_STACK_DATA_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 14,
    LEFT_STACK_CANARY_DIED_AND_LEFT_STACK_DATA_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 13,
    LEFT_STACK_CANARY_DIED_AND_RIGHT_STACK_CANARY_DIED_AND_RIGHT_STACK_DATA_CANARY_DIED = 11,
    LEFT_STACK_CANARY_DIED_AND_RIGHT_STACK_CANARY_DIED_AND_LEFT_STACK_DATA_CANARY_DIED = 7,
    ALL_CANARIES_DIED = 15,
    STACK_IS_EMPTY = 16,
    STACK_NULLPTR = 32,
    STACK_DATA_NULLPTR = 64,
    STACK_CALLOC_ERROR = 128,
    STACK_REALLOC_ERROR = 256,
    STACK_EMPTY = 512
};
#include "stack.h"

void StackDump (const struct stack* p, char* stackname, char* file, int numline, const char* func);
STACK_ERROR CanaryCtor (struct stack* p);
STACK_ERROR IsAliveCanary (struct stack* p);
STACK_ERROR DataCtor (struct stack* p);
STACK_ERROR DataReCtorPush (struct stack* p);
STACK_ERROR DataReCtorPop (struct stack* p);
STACK_ERROR StackVerifi (struct stack* p);

#endif
